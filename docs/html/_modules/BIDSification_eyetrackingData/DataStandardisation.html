
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BIDSification_eyetrackingData.DataStandardisation &#8212; BIDSification eyetracking Data 0.0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/_static/custom.css" />
    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">BIDSification eyetracking Data</a></h1>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=invibe&repo=ANEMO&type=watch&count=False&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>






<h3><a href="../../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../1_InfoFile.html">InfoFiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../2_SettingsFile.html">Setting File</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../3_BIDSification.html">Data standardisation</a></li>
</ul>

<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
              <div class="related top">
                &nbsp;
  <nav id="rellinks">
    <ul>
    </ul>
  </nav>
              </div>
          

          <div class="body" role="main">
            
  <h1>Source code for BIDSification_eyetrackingData.DataStandardisation</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/env python</span>
<span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">.File</span> <span class="kn">import</span> <span class="n">open_file</span><span class="p">,</span> <span class="n">save_file</span>
<span class="kn">from</span> <span class="nn">.StandardisationProcess</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.StandardisationProcessDataEyelink</span> <span class="kn">import</span> <span class="o">*</span>

<div class="viewcode-block" id="DataStandardisation"><a class="viewcode-back" href="../../3_BIDSification.html#BIDSification_eyetrackingData.DataStandardisation">[docs]</a><span class="k">class</span> <span class="nc">DataStandardisation</span><span class="p">:</span>

    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Standardization of data</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    path_oldData: str</span>
<span class="sd">        Path of the data directory to BIDSified</span>
<span class="sd">    path_newData: str</span>
<span class="sd">        Path of the new BIDS data directory</span>

<span class="sd">    infofilesname: str</span>
<span class="sd">        Name of the file containing the information on the files to be</span>
<span class="sd">        BIDSified</span>
<span class="sd">    settingsfilename: str</span>
<span class="sd">        Name of the file containing the settings of the data to be</span>
<span class="sd">        BIDSified</span>

<span class="sd">    eyetacktype: str</span>
<span class="sd">        Name of the type of eyetackeur used</span>
<span class="sd">    dataformat: str</span>
<span class="sd">        Data format</span>
<span class="sd">    saved_events: list</span>
<span class="sd">        List of events to be extracted from the trials</span>

<span class="sd">    StartMessage: str</span>
<span class="sd">        Message marking the start of the trial</span>
<span class="sd">    EndMessage: str</span>
<span class="sd">        Message marking the end of the trial</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path_oldData</span><span class="p">,</span> <span class="n">path_newData</span><span class="p">,</span> <span class="n">infofilesname</span><span class="p">,</span>
                 <span class="n">settingsfilename</span><span class="p">,</span> <span class="n">eyetacktype</span><span class="p">,</span> <span class="n">dataformat</span><span class="p">,</span> <span class="n">saved_events</span><span class="p">,</span>
                 <span class="n">StartMessage</span><span class="p">,</span> <span class="n">EndMessage</span><span class="p">):</span>

        <span class="c1"># checks if the directory of the data to be BISDified exists</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">path_oldData</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Directory &#39;</span><span class="si">%s</span><span class="s2">&#39; does not exist&quot;</span><span class="o">%</span><span class="n">path_oldData</span><span class="p">)</span>


        <span class="c1"># global variable</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eyetacktype</span> <span class="o">=</span> <span class="n">eyetacktype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saved_events</span> <span class="o">=</span> <span class="n">saved_events</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="kc">None</span>


        <span class="c1"># Standard process</span>
        <span class="c1">#----------------------------------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span> <span class="o">=</span> <span class="n">StandardisationProcess</span><span class="p">(</span><span class="n">path_oldData</span><span class="p">)</span>
        <span class="c1"># Check the information file on all the data files present in the</span>
        <span class="c1">#  directory</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">check_infoFiles</span><span class="p">(</span><span class="n">infofilesname</span><span class="p">,</span> <span class="n">dataformat</span><span class="p">)</span>
        <span class="n">infofilesname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">infofilesname</span>
        <span class="c1"># Sort infoFiles to give a dictionnary of list of settings per file and</span>
        <span class="c1">#  per participant</span>
        <span class="n">infos</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">sort_infoFiles</span><span class="p">(</span><span class="n">infofilesname</span><span class="p">)</span>

        <span class="c1"># Eyetracking process</span>
        <span class="c1">#----------------------------------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_ET</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eyetacktype</span><span class="o">==</span><span class="s1">&#39;Eyelink&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_ET</span> <span class="o">=</span> <span class="n">StandardisationProcessDataEyelink</span><span class="p">(</span><span class="n">path_oldData</span><span class="p">,</span>
                                                                <span class="n">StartMessage</span><span class="p">,</span>
                                                                <span class="n">EndMessage</span><span class="p">)</span>

        <span class="c1">#######################################################################</span>
        <span class="c1">#  BIDSification of all files in infoFiles</span>
        <span class="c1">#######################################################################</span>

        <span class="c1"># Open the information file</span>
        <span class="n">infoFiles</span> <span class="o">=</span> <span class="n">open_file</span><span class="p">(</span><span class="n">infofilesname</span><span class="p">,</span> <span class="n">path_oldData</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">infoFiles</span><span class="p">:</span>

            <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;participant_id&#39;</span><span class="p">])</span>

            <span class="c1"># creation of the path to the old data</span>
            <span class="c1">#------------------------------------------------------------------</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path_oldData</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="s1">&#39;filepath&#39;</span><span class="p">])</span>

            <span class="c1"># creation of the directory that will contain the data to be</span>
            <span class="c1">#  BIDSified if it does not already exist</span>
            <span class="c1">#------------------------------------------------------------------</span>
            <span class="n">new_filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_filepath</span><span class="p">(</span><span class="n">infoFile</span><span class="o">=</span><span class="n">f</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path_newData</span><span class="p">)</span>


            <span class="c1"># creation of the file names of the BIDSified data</span>
            <span class="c1">#------------------------------------------------------------------</span>
            <span class="n">new_filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">create_filename</span><span class="p">(</span><span class="n">infoFile</span><span class="o">=</span><span class="n">f</span><span class="p">)</span>

            <span class="c1">###################################################################</span>
            <span class="c1">#  CREATION OF THE FILES</span>
            <span class="c1">###################################################################</span>
            <span class="n">arg</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;filename&#39;</span><span class="p">],</span> <span class="n">filepath</span><span class="o">=</span><span class="n">filepath</span><span class="p">,</span>
                       <span class="n">new_filename</span><span class="o">=</span><span class="n">new_filename</span><span class="p">,</span> <span class="n">new_filepath</span><span class="o">=</span><span class="n">new_filepath</span><span class="p">)</span>

            <span class="c1"># FILES *_eyetrack</span>
            <span class="c1">#------------------------------------------------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_SettingsFile</span><span class="p">(</span><span class="n">settingsfilename</span><span class="o">=</span><span class="n">settingsfilename</span><span class="p">,</span>
                                     <span class="n">infofilesname</span><span class="o">=</span><span class="n">infofilesname</span><span class="p">,</span>
                                     <span class="n">list_settings</span><span class="o">=</span><span class="n">infos</span><span class="p">[</span><span class="s1">&#39;file&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">arg</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_DataFile</span><span class="p">(</span><span class="o">**</span><span class="n">arg</span><span class="p">)</span>

            <span class="c1"># FILE *_events</span>
            <span class="c1">#------------------------------------------------------------------</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">create_EventsFile</span><span class="p">(</span><span class="n">eventsfilename</span><span class="o">=</span><span class="n">f</span><span class="p">[</span><span class="s1">&#39;eventsfilename&#39;</span><span class="p">],</span> <span class="o">**</span><span class="n">arg</span><span class="p">)</span>

        <span class="c1"># FILE *_participant.tsv</span>
        <span class="c1">#----------------------------------------------------------------------</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">create_InfoParticipantsFile</span><span class="p">(</span><span class="n">infofilesname</span><span class="o">=</span><span class="n">infofilesname</span><span class="p">,</span>
                                         <span class="n">list_settings</span><span class="o">=</span><span class="n">infos</span><span class="p">[</span><span class="s1">&#39;participant&#39;</span><span class="p">],</span>
                                         <span class="n">path</span><span class="o">=</span><span class="n">path_newData</span><span class="p">)</span>
        <span class="c1">#######################################################################</span>

    <span class="k">def</span> <span class="nf">create_filepath</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infoFile</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creation of the directory that will contain the data to be BIDSified if</span>
<span class="sd">        it does not already exist</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        infoFile: dict</span>
<span class="sd">            Dictionary containing the information on the data to be BIDSified</span>
<span class="sd">        path: str</span>
<span class="sd">            Path of the new BIDS data directory</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        filepath: str</span>
<span class="sd">            Path of the file</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Creation of file path</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="s1">&#39;sub-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">infoFile</span><span class="p">[</span><span class="s1">&#39;participant_id&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">infoFile</span><span class="p">[</span><span class="s1">&#39;ses&#39;</span><span class="p">]:</span>
            <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;ses-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">infoFile</span><span class="p">[</span><span class="s1">&#39;ses&#39;</span><span class="p">]))</span>
        <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="s1">&#39;eyetrack&#39;</span><span class="p">)</span>

        <span class="c1"># Creation of the directory if not exist</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">filepath</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">filepath</span>

    <span class="k">def</span> <span class="nf">create_filename</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infoFile</span><span class="p">):</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creation of the file names of the BIDSified data</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        infoFile: dict</span>
<span class="sd">            Dictionary containing the information on the data to be BIDSified</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        filename: str</span>
<span class="sd">            Name of the file</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># Creation of the file names</span>
        <span class="n">filename</span>  <span class="o">=</span> <span class="s1">&#39;sub-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">infoFile</span><span class="p">[</span><span class="s1">&#39;participant_id&#39;</span><span class="p">])</span>
        <span class="n">filename</span> <span class="o">+=</span> <span class="s1">&#39;_ses-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">infoFile</span><span class="p">[</span><span class="s1">&#39;ses&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="n">infoFile</span><span class="p">[</span><span class="s1">&#39;ses&#39;</span><span class="p">]</span>  <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="n">filename</span> <span class="o">+=</span> <span class="s1">&#39;_task-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">infoFile</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="n">infoFile</span><span class="p">[</span><span class="s1">&#39;task&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="n">filename</span> <span class="o">+=</span> <span class="s1">&#39;_acq-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">infoFile</span><span class="p">[</span><span class="s1">&#39;acq&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="n">infoFile</span><span class="p">[</span><span class="s1">&#39;acq&#39;</span><span class="p">]</span>  <span class="k">else</span> <span class="s1">&#39;&#39;</span>
        <span class="n">filename</span> <span class="o">+=</span> <span class="s1">&#39;_run-&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">infoFile</span><span class="p">[</span><span class="s1">&#39;run&#39;</span><span class="p">])</span> <span class="k">if</span> <span class="n">infoFile</span><span class="p">[</span><span class="s1">&#39;run&#39;</span><span class="p">]</span>  <span class="k">else</span> <span class="s1">&#39;&#39;</span>

        <span class="k">return</span> <span class="n">filename</span>



    <span class="k">def</span> <span class="nf">create_SettingsFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">new_filename</span><span class="p">,</span>
                            <span class="n">new_filepath</span><span class="p">,</span> <span class="n">settingsfilename</span><span class="p">,</span> <span class="n">infofilesname</span><span class="p">,</span>
                            <span class="n">list_settings</span><span class="p">):</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creation of a settings file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename: str</span>
<span class="sd">            Name of the data file to be BIDSified</span>
<span class="sd">        filepath: str</span>
<span class="sd">            Path of the data file to be BIDSified</span>
<span class="sd">        new_filename: str</span>
<span class="sd">            New name of the settings file to be BIDSified</span>
<span class="sd">        new_filepath: str</span>
<span class="sd">            New path of the settings file to be BIDSified</span>
<span class="sd">        settingsfile: str</span>
<span class="sd">            Name of the file containing the settings of the data to be</span>
<span class="sd">            BIDSified</span>
<span class="sd">        infofilesname: str</span>
<span class="sd">            Name of the file containing the information on the files to be</span>
<span class="sd">            BIDSified</span>
<span class="sd">        list_settings: list</span>
<span class="sd">            List of settings to be extracted</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">settings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">settings_init</span><span class="p">()</span>

        <span class="c1"># Extract settings in asc files</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_ET</span><span class="p">:</span>
            <span class="n">settings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_ET</span><span class="o">.</span><span class="n">Extract_settings_ascFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span>
                                                                <span class="n">filepath</span><span class="p">,</span>
                                                                <span class="n">settings</span><span class="p">)</span>

        <span class="c1"># Extract settings in json files</span>
        <span class="k">if</span> <span class="n">settingsfilename</span><span class="p">:</span>
            <span class="n">settings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">Extract_settings_jsonFile</span><span class="p">(</span><span class="n">settingsfilename</span><span class="p">,</span>
                                                              <span class="n">settings</span><span class="p">)</span>

        <span class="c1"># Extract settings in tsv files</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">Extract_settings_infoFiles</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span>
                                                           <span class="n">infofilesname</span><span class="p">,</span>
                                                           <span class="n">list_settings</span><span class="p">,</span>
                                                           <span class="n">settings</span><span class="p">)</span>

        <span class="c1"># Check that all the required settings are filled</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">Check_required_settings</span><span class="p">(</span><span class="n">settings</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="n">settings</span>

        <span class="c1"># save settings</span>
        <span class="n">save_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span> <span class="n">new_filename</span><span class="o">+</span><span class="s1">&#39;_eyetrack.json&#39;</span><span class="p">,</span> <span class="n">new_filepath</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">create_DataFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span> <span class="n">new_filename</span><span class="p">,</span> <span class="n">new_filepath</span><span class="p">):</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creation of a data file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename: str</span>
<span class="sd">            Name of the data file to be BIDSified</span>
<span class="sd">        filepath: str</span>
<span class="sd">            Path of the data file to be BIDSified</span>
<span class="sd">        new_filename: str</span>
<span class="sd">            New name of the data file to be BIDSified</span>
<span class="sd">        new_filepath: str</span>
<span class="sd">            New path of the data file to be BIDSified</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">new_filename</span> <span class="o">=</span> <span class="n">new_filename</span><span class="o">+</span><span class="s1">&#39;_eyetrack&#39;</span>

        <span class="c1"># save file .asc</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">eyetacktype</span><span class="o">==</span><span class="s1">&#39;Eyelink&#39;</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">shutil</span>
            <span class="n">shutil</span><span class="o">.</span><span class="n">copy2</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">filepath</span><span class="p">,</span> <span class="n">filename</span><span class="p">),</span>
                         <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_filepath</span><span class="p">,</span> <span class="n">new_filename</span><span class="o">+</span><span class="s1">&#39;.asc&#39;</span><span class="p">))</span>

        <span class="c1"># Extract data in asc file pour convertir les donn√©es en tsv</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_ET</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_ET</span><span class="o">.</span><span class="n">Extract_data_ascFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">filepath</span><span class="p">)</span>
            <span class="c1"># save data</span>
            <span class="n">save_file</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">new_filename</span><span class="o">+</span><span class="s1">&#39;.tsv&#39;</span><span class="p">,</span> <span class="n">new_filepath</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">create_EventsFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">eventsfilename</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span>
                          <span class="n">new_filename</span><span class="p">,</span> <span class="n">new_filepath</span><span class="p">):</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creation of a events file</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename: str</span>
<span class="sd">            Name of the data file to be BIDSified</span>
<span class="sd">        eventsfilename: str</span>
<span class="sd">            Name of the events file to be BIDSified</span>
<span class="sd">        filepath: str</span>
<span class="sd">            Path of the data file to be BIDSified</span>
<span class="sd">        new_filename: str</span>
<span class="sd">            New name of the events file to be BIDSified</span>
<span class="sd">        new_filepath: str</span>
<span class="sd">            New path of the events file to be BIDSified</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">events_init</span><span class="p">()</span>

        <span class="c1"># Extract Events in asc files</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_ET</span><span class="p">:</span>
            <span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process_ET</span><span class="o">.</span><span class="n">Extract_events_ascFile</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">filepath</span><span class="p">,</span>
                                                            <span class="bp">self</span><span class="o">.</span><span class="n">saved_events</span><span class="p">,</span>
                                                            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">,</span>
                                                            <span class="n">events</span><span class="p">)</span>
        <span class="c1"># Extract Events in tsv files</span>
        <span class="k">if</span> <span class="n">eventsfilename</span><span class="p">:</span>
            <span class="n">events</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">Extract_events_tsvFile</span><span class="p">(</span><span class="n">eventsfilename</span><span class="p">,</span>
                                                         <span class="n">filepath</span><span class="p">,</span> <span class="n">events</span><span class="p">)</span>

        <span class="c1"># save events</span>
        <span class="n">save_file</span><span class="p">(</span><span class="n">events</span><span class="p">,</span> <span class="n">new_filename</span><span class="o">+</span><span class="s1">&#39;_events.tsv&#39;</span><span class="p">,</span> <span class="n">new_filepath</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">create_InfoParticipantsFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">infofilesname</span><span class="p">,</span> <span class="n">list_settings</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>

        <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Creation of an information file on participants</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        infofilesname: str</span>
<span class="sd">            Name of the file containing the information on the files to be</span>
<span class="sd">            BIDSified</span>
<span class="sd">        list_settings: list</span>
<span class="sd">            List of settings to be extracted</span>
<span class="sd">        path: str</span>
<span class="sd">            Path of the new BIDS dara directory</span>
<span class="sd">        &#39;&#39;&#39;</span>

        <span class="c1"># extract info participants in infoFiles</span>
        <span class="n">participant</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">Extract_infoParticipants</span><span class="p">(</span><span class="n">infofilesname</span><span class="p">,</span>
                                                            <span class="n">list_settings</span><span class="p">)</span>

        <span class="c1"># creation of file name</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">taskname</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;task-&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">process</span><span class="o">.</span><span class="n">taskname</span><span class="o">+</span><span class="s1">&#39;_participants.tsv&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">filename</span> <span class="o">=</span> <span class="s1">&#39;participants.tsv&#39;</span>

        <span class="c1"># save participant</span>
        <span class="n">save_file</span><span class="p">(</span><span class="n">participant</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">path</span><span class="p">)</span></div>

</pre></div>

          </div>
              <div class="related bottom">
                &nbsp;
  <nav id="rellinks">
    <ul>
    </ul>
  </nav>
              </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      
      
    </div>

    

    
  </body>
</html>